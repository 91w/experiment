{"remainingRequest":"D:\\myShop\\cmall-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myShop\\cmall-vue\\src\\views\\CallbackQQ.vue?vue&type=style&index=0&id=d8fd7742&scoped=true&lang=css","dependencies":[{"path":"D:\\myShop\\cmall-vue\\src\\views\\CallbackQQ.vue","mtime":1713966379499},{"path":"D:\\myShop\\cmall-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1714004800405},{"path":"D:\\myShop\\cmall-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1714004801776},{"path":"D:\\myShop\\cmall-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1714004800978},{"path":"D:\\myShop\\cmall-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1714004799971},{"path":"D:\\myShop\\cmall-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1714004801336}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouY2FsbGJhY2sgLmNhbGxiYWNrLWNvbnRlbnQgew0KICBoZWlnaHQ6IDcwMHB4Ow0KICB3aWR0aDogMTAwJTsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCi5jYWxsYmFjayAuY2FsbGJhY2stY29udGVudCAuY2FsbGJhY2stdGV4dCB7DQogIGNvbG9yOiAjNzU3NTc1Ow0KICB3aWR0aDogNTAwcHg7DQogIG1hcmdpbjogMCBhdXRvOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQo="},{"version":3,"sources":["CallbackQQ.vue"],"names":[],"mappings":";AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CallbackQQ.vue","sourceRoot":"src/views","sourcesContent":["<!--\r\n * @Descripttion: 关于QQ回调组件\r\n * @Author: congz\r\n * @Date: 2020-07-11 19:29:46\r\n * @LastEditors: congz\r\n * @LastEditTime: 2020-08-19 10:39:48\r\n--> \r\n\r\n\r\n<template>\r\n  <div class=\"callback\" id=\"callback\" name=\"callback\">\r\n    <div class=\"callback-content\">\r\n      <div class=\"callback-text\">\r\n        <p>正在登录中...</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport * as userAPI from '@/api/users'\r\nexport default {\r\n  name: 'CallbackQQ',\r\n\r\n  data() {\r\n    return {\r\n      code: '',\r\n      state: ''\r\n    }\r\n  },\r\n  activated() {\r\n    if (this.$route.query.code != undefined) {\r\n      this.code = this.$route.query.code\r\n    }\r\n    if (this.$route.query.state != undefined) {\r\n      this.state = this.$route.query.state\r\n    }\r\n  },\r\n  watch: {\r\n    // 监听code的变化\r\n    code: function() {\r\n      this.qqLogin()\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions(['setUser']),\r\n    qqLogin() {\r\n      if (this.state != 'congz') {\r\n        this.notifyError('不是本站的请求', '')\r\n        return\r\n      }\r\n      userAPI\r\n        .qqLogin(this.code)\r\n        .then(res => {\r\n          if (res.status == 200) {\r\n            // 登录信息存到本地\r\n            let user = JSON.stringify(res.data.user)\r\n            localStorage.setItem('user', user)\r\n            localStorage.setItem('token', res.data.token)\r\n            // 登录信息存到vuex\r\n            this.setUser(res.data.user)\r\n            this.$router.push({\r\n              name: 'Home'\r\n            })\r\n            // 弹出通知框提示登录成功信息\r\n            this.notifySucceed('登录成功')\r\n          } else {\r\n            this.notifyError('登录失败', res.msg)\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.notifyError('登录失败', error)\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.callback .callback-content {\r\n  height: 700px;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.callback .callback-content .callback-text {\r\n  color: #757575;\r\n  width: 500px;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n</style>"]}]}