{"remainingRequest":"D:\\myShop\\cmall-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myShop\\cmall-vue\\src\\views\\CallbackQQ.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\myShop\\cmall-vue\\src\\views\\CallbackQQ.vue","mtime":1714377406330},{"path":"D:\\myShop\\cmall-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1714004799971},{"path":"D:\\myShop\\cmall-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1714004800982},{"path":"D:\\myShop\\cmall-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1714004799971},{"path":"D:\\myShop\\cmall-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1714004801336}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcNCmltcG9ydCAqIGFzIHVzZXJBUEkgZnJvbSAnQC9hcGkvdXNlcnMnDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdDYWxsYmFja1FRJywNCg0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBjb2RlOiAnJywNCiAgICAgIHN0YXRlOiAnJw0KICAgIH0NCiAgfSwNCiAgYWN0aXZhdGVkKCkgew0KICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS5jb2RlICE9IHVuZGVmaW5lZCkgew0KICAgICAgdGhpcy5jb2RlID0gdGhpcy4kcm91dGUucXVlcnkuY29kZQ0KICAgIH0NCiAgICBpZiAodGhpcy4kcm91dGUucXVlcnkuc3RhdGUgIT0gdW5kZWZpbmVkKSB7DQogICAgICB0aGlzLnN0YXRlID0gdGhpcy4kcm91dGUucXVlcnkuc3RhdGUNCiAgICB9DQogIH0sDQogIHdhdGNoOiB7DQogICAgLy8g55uR5ZCsY29kZeeahOWPmOWMlg0KICAgIGNvZGU6IGZ1bmN0aW9uKCkgew0KICAgICAgdGhpcy5xcUxvZ2luKCkNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAuLi5tYXBBY3Rpb25zKFsnc2V0VXNlciddKSwNCiAgICBxcUxvZ2luKCkgew0KICAgICAgaWYgKHRoaXMuc3RhdGUgIT0gJ2Nvbmd6Jykgew0KICAgICAgICB0aGlzLm5vdGlmeUVycm9yKCfkuI3mmK/mnKznq5nnmoTor7fmsYInLCAnJykNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICB1c2VyQVBJDQogICAgICAgIC5xcUxvZ2luKHRoaXMuY29kZSkNCiAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHsNCiAgICAgICAgICAgIC8vIOeZu+W9leS/oeaBr+WtmOWIsOacrOWcsA0KICAgICAgICAgICAgbGV0IHVzZXIgPSBKU09OLnN0cmluZ2lmeShyZXMuZGF0YS51c2VyKQ0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCB1c2VyKQ0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Rva2VuJywgcmVzLmRhdGEudG9rZW4pDQogICAgICAgICAgICAvLyDnmbvlvZXkv6Hmga/lrZjliLB2dWV4DQogICAgICAgICAgICB0aGlzLnNldFVzZXIocmVzLmRhdGEudXNlcikNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsNCiAgICAgICAgICAgICAgbmFtZTogJ0hvbWUnDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLy8g5by55Ye66YCa55+l5qGG5o+Q56S655m75b2V5oiQ5Yqf5L+h5oGvDQogICAgICAgICAgICB0aGlzLm5vdGlmeVN1Y2NlZWQoJ+eZu+W9leaIkOWKnycpDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IoJ+eZu+W9leWksei0pScsIHJlcy5tc2cpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgIHRoaXMubm90aWZ5RXJyb3IoJ+eZu+W9leWksei0pScsIGVycm9yKQ0KICAgICAgICB9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["CallbackQQ.vue"],"names":[],"mappings":";AAmBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CallbackQQ.vue","sourceRoot":"src/views","sourcesContent":["<!--\r\n * @Descripttion: 关于QQ回调组件\r\n * @Author: congz\r\n * @Date: 2020-07-11 19:29:46\r\n * @LastEditors: congz\r\n * @LastEditTime: 2020-08-19 10:39:48\r\n--> \r\n\r\n\r\n<template>\r\n  <div class=\"callback\" id=\"callback\" name=\"callback\">\r\n    <div class=\"callback-content\">\r\n      <div class=\"callback-text\">\r\n        <p>正在登录中...</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport * as userAPI from '@/api/users'\r\nexport default {\r\n  name: 'CallbackQQ',\r\n\r\n  data() {\r\n    return {\r\n      code: '',\r\n      state: ''\r\n    }\r\n  },\r\n  activated() {\r\n    if (this.$route.query.code != undefined) {\r\n      this.code = this.$route.query.code\r\n    }\r\n    if (this.$route.query.state != undefined) {\r\n      this.state = this.$route.query.state\r\n    }\r\n  },\r\n  watch: {\r\n    // 监听code的变化\r\n    code: function() {\r\n      this.qqLogin()\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions(['setUser']),\r\n    qqLogin() {\r\n      if (this.state != 'congz') {\r\n        this.notifyError('不是本站的请求', '')\r\n        return\r\n      }\r\n      userAPI\r\n        .qqLogin(this.code)\r\n        .then(res => {\r\n          if (res.status == 200) {\r\n            // 登录信息存到本地\r\n            let user = JSON.stringify(res.data.user)\r\n            localStorage.setItem('user', user)\r\n            localStorage.setItem('token', res.data.token)\r\n            // 登录信息存到vuex\r\n            this.setUser(res.data.user)\r\n            this.$router.push({\r\n              name: 'Home'\r\n            })\r\n            // 弹出通知框提示登录成功信息\r\n            this.notifySucceed('登录成功')\r\n          } else {\r\n            this.notifyError('登录失败', res.msg)\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.notifyError('登录失败', error)\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.callback .callback-content {\r\n  height: 700px;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.callback .callback-content .callback-text {\r\n  color: #757575;\r\n  width: 500px;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n</style>"]}]}